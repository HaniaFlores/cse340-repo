<h1>
    <%= title %>
</h1>

<%- messages() %>

<% if (errors) { %>
  <ul class="notice">
 <% errors.array().forEach(error => { %>
   <li><%= error.msg %></li>
<%  }) %>
 </ul>
<% } %>

<%
  const user      = locals.accountData || {};
  const stickyId  = (typeof account_id        !== "undefined") ? account_id        : user.account_id;
  const stickyFn  = (typeof account_firstname !== "undefined") ? account_firstname : user.account_firstname;
  const stickyLn  = (typeof account_lastname  !== "undefined") ? account_lastname  : user.account_lastname;
  const stickyEm  = (typeof account_email     !== "undefined") ? account_email     : user.account_email;
%>

<!-- Account Update -->
<section>
  <h2>Account Update</h2>
  <form class="form-display" action="/account/update" method="post" novalidate>
    <fieldset>
      <label for="account_firstname">First name</label>
      <input
        id="account_firstname"
        name="account_firstname"
        type="text"
        minlength="2"
        required
        value="<%= stickyFn || '' %>"
      >

      <label for="account_lastname">Last name</label>
      <input
        id="account_lastname"
        name="account_lastname"
        type="text"
        minlength="2"
        required
        value="<%= stickyLn || '' %>"
      >

      <label for="account_email">Email address</label>
      <input
        id="account_email"
        name="account_email"
        type="email"
        required
        value="<%= stickyEm || '' %>"
      >

      <input type="hidden" name="account_id" value="<%= stickyId %>">

      <input type="submit" value="Save Changes">
    </fieldset>
  </form>
</section>

<!-- Change Password -->
<section style="margin-top: 2rem;">
  <h2>Change Password</h2>
  <p>
    Enter a new password to replace your current password.
    It must be at least 12 characters and include an uppercase letter, a lowercase letter,
    a number, and a special character.
  </p>

  <form class="form-display" action="/account/update-password" method="post" novalidate>
    <fieldset>
      <label for="account_password">New password</label>
      <input
        id="account_password"
        name="account_password"
        type="password"
        required
        pattern="^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\\s).{12,}$"
        autocomplete="new-password"
      >

      <input type="hidden" name="account_id" value="<%= stickyId %>">

      <input type="submit" value="Change Password">
    </fieldset>
  </form>
</section>